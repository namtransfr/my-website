$device='desktop';$tc=$('meta[name="pt:data"]').attr("content");var start=Date.now();var tmp;var OSName="Unknown OS";var isActive,okay=true;var $referrer=document.referrer;var $url_ajax='/forum/datacst/streamclick';var $location_type=1;$url=window.location.href;$user_agent=(navigator.userAgent).substring(0,200);$browser=navigator.sayswho;$os=OSName;$topic_id=0;$scrollTop=0;var chk_click=true;detail_data={};$(document).on('click','.img-emotion-item',function(e){$toyname=$(this).attr('title');$event='toy';$action=$(this).parents('#links_lb_process').attr("data-refzcomment");ajax_process($event);});$(document).on('click','.btn-bookmarks',function(e){$tmp=$(this).attr("title");if($tmp=='เก็บเป็นกระทู้โปรด'){$event='bookmark:add';}else{$event='bookmark:del';}
$comment_id=$(this).parents('.display-post-wrapper').find("div").attr('class');if($comment_id==='main-post-inner sticky-navi-comment'){$comment_id='0'}
if($comment_id!=undefined){$comment_id=$comment_id.replace('comment','');}
ajax_process($event);});$(document).on('click','.video_id',function(e){$youtube_url=$(this).attr("href");$event='youtube';$comment_id=$(this).parents('.display-post-wrapper').find(".display-post-number").text();;if($comment_id===''){$comment_id=$(this).parents('.display-post-wrapper').find("div").attr('class');if($comment_id==='main-post-inner sticky-navi-comment'){$comment_id='0'}}
if($comment_id!=undefined){$comment_id=$comment_id.replace('comment','');}
ajax_process($event);});$(document).on('click','.icon-heart-like',function(e){if($(this).hasClass("i-vote")){$event='vote:del';}else{$event='vote:add';}
$comment_id=$(this).parents('.display-post-wrapper').find(".display-post-number").text();if($comment_id===''){$comment_id=$(this).parents('.display-post-wrapper').find("div").attr('class');if($comment_id==='main-post-inner sticky-navi-comment'){$comment_id='0'}}
ajax_process($event);});$(document).on('click','.display-post-avatar a',function(e){$profile_temp=$(this).attr("href");$profile_mid=$profile_temp.match(/[ 0-9 ]+/);$event='profile';$comment_id=$(this).parents('.display-post-wrapper').find(".display-post-number").text();if($comment_id===''){$comment_id=$(this).parents('.display-post-wrapper').find("div").attr('class');if($comment_id==='main-post-inner sticky-navi-comment'){$comment_id='0'}}
if($comment_id!=undefined){$comment_id=$comment_id.replace('comment','');}
ajax_process($event);});$(document).on('click','.emotion-choice-icon',function(e){if($(this).hasClass("emo-01")){$event='emo:like';}else if($(this).hasClass("emo-02")){$event='emo:haha';}else if($(this).hasClass("emo-03")){$event='emo:love';}else if($(this).hasClass("emo-04")){$event='emo:impress';}else if($(this).hasClass("emo-05")){$event='emo:scare';}else{$event='emo:wow';}
$comment_id=$(this).parents('.display-post-wrapper').find(".display-post-number").text();if($comment_id===''){$comment_id=$(this).parents('.display-post-wrapper').find("div").attr('class');if($comment_id==='main-post-inner sticky-navi-comment'){$comment_id='0';}}
ajax_process($event);});$(document).on('click','.icon-unpin , .spoil-btn , .icon-reportbin',function(e){if($(this).hasClass("icon-unpin")){$event='pinit';}else if($(this).hasClass("spoil-btn")){$event='spoil';}else{$event='inform';}
$comment_id=$(this).parents('.display-post-wrapper').find(".display-post-number").text();if($comment_id===''){$comment_id=$(this).parents('.display-post-wrapper').find("div").attr('class');if($comment_id==='main-post-inner sticky-navi-comment'){$comment_id='0'}}
ajax_process($event);});$(document).on('click','.desktop-sharing img',function(e){$share_butt=$(this).attr("alt");if($share_butt=='facebook button'){$event='share:facebook';}else if($share_butt=='twitter button'){$event='share:twitter';}else if($share_butt=='line button'){$event='share:line';}else{$event='share:copy-link';}
ajax_process($event);});$(document).on('click','a , button',function(e){$topic_id=0;if(chk_click===true){var arrTopic=($(".main-post").attr("id"));if(arrTopic!=undefined){$topic_id=arrTopic.replace(/^.*topic-([0-9]+).*$/,"$1");}
$event='click';var detail_xy={};var detail_click={}
detail_click=getDetailElementData(this);detail_xy=getWidthHeightElement(e);detail_data=Object.assign(detail_click,detail_xy);ajax_process($event);}});function pageShown(evt){if(typeof latitude=="undefined"||typeof longitude=="undefined"||typeof latitude=="null"||typeof longitude=="null"){latitude='Disallow';longitude='Disallow';}
$url=window.location.href;$event="start";$user_agent=(navigator.userAgent).substring(0,200);ajax_process($event);}
window.addEventListener("pageshow",pageShown,false);$(document).ready(function(){$topic_id=($(".main-post").attr("id"));if(typeof $topic_id==undefined||typeof $topic_id=='undefined'){$topic_id='0';}else{try{$topic_id=$topic_id.match(/[ 0-9 ]+/);}catch(e){$topic_id=window.location.href.match(/[ 0-9 ]+/);}}
navigator.sayswho=(function(){var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return'IE '+(tem[1]||'');}
if(M[1]==='Chrome'){tem=ua.match(/\b(OPR|Edge)\/(\d+)/);if(tem!=null)
return tem.slice(1).join(' ').replace('OPR','Opera');}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null)
M.splice(1,1,tem[1]);return M.join(' ');})();if(navigator.appVersion.indexOf("Win")!=-1)
OSName="Windows";if(navigator.appVersion.indexOf("Mac")!=-1)
OSName="MacOS";if(navigator.appVersion.indexOf("X11")!=-1)
OSName="UNIX";if(navigator.appVersion.indexOf("Linux")!=-1)
OSName="Linux";});var successCallback=function(position){x=position.coords.latitude;y=position.coords.longitude;$location_type=1;};var errorCallback=function(error){var errorMessage='Unknown error';switch(error.code){case 1:x=0;y=0;$location_type='Permission denied';break;case 2:x=0;y=0;$location_type='Position unavailable';break;case 3:x=0;y=0;$location_type='Timeout';break;}};var options={enableHighAccuracy:true,timeout:1000,maximumAge:0};function get_comment_from_url(){return $url.match(/comment[0-9]*[-]*[0-9]*/g);}
function ajax_process($evt){if($evt=='start'){if(($referrer).length==0){$referrer='0';}
$comment_id=get_comment_from_url();if($comment_id==null){$comment_id=0;}
$add_on='&referrer='+encodeURIComponent($referrer)+'&user_agent='+$user_agent+'&os='+OSName+'&browser='+navigator.sayswho;}else if($evt=='toy'){$add_on='&toyname='+$toyname+'&os='+OSName+'&browser='+navigator.sayswho;}else if($evt=='youtube'){$add_on='&youtube='+$youtube_url+'&os='+OSName+'&browser='+navigator.sayswho;}else if($evt=='profile'){$add_on='&profile='+$profile_mid+'&os='+OSName+'&browser='+navigator.sayswho;}else{$add_on='&os='+OSName+'&browser='+navigator.sayswho;}
if(typeof x=='undefined'||typeof y=='undefined'||typeof x==undefined||typeof y==undefined||typeof x==null||typeof y==null||typeof x=='undefined'||typeof y=='undefined'||typeof x=='null'||typeof y=='null'){x=0;y=0;$location_type='Ignore';}
if((typeof $comment_id=='object')){$comment_id=String($comment_id);if(!$comment_id.match(/([0-9])+$/i)){$comment_id='0';}}
if((typeof $comment_id=='string')){if(!$comment_id.match(/([0-9])+$/i)){$comment_id='0';}
else{$comment_id=$comment_id.replace(/^.*(?:comment|ความคิดเห็นที่ +|P|E)([0-9\-]+).*$/,"$1");}}
else{$comment_id='0';}
if($evt=='toy'){$comment_id=$action;}
$data='url='+encodeURIComponent($url)+'&tc='+$tc+'&location='+x+','+y+'&status_location='+$location_type+'&event='+$evt
+'&topic_id='+$topic_id+'&comment_id='+$comment_id+'&device='+$device
+$add_on;var jsonDataPost={};jsonDataPost=$data;if($evt=='click'){var strUrl=$url;if(strUrl.search('comment')==-1){$comment_id='0';}
else{$comment_id=strUrl.replace(/^.+\/topic\/[0-9]+\/comment([0-9\-]+).*$/,"$1");}
var addDataOn={'url':encodeURIComponent($url),'topic_id':$topic_id,'comment_id':$comment_id,'tc':$tc,'location':x+','+y,'status_location':$location_type,'event':$evt,'device':$device,'referrer':encodeURIComponent($referrer),'user_agent':$user_agent,'os':OSName,'browser':navigator.sayswho};jsonDataPost={'data':addDataOn,'detail_data':detail_data};}
$.ajax({url:$url_ajax,type:'post',data:jsonDataPost,success:function($json){okay=false;},error:function(xhr,ajaxOptions,thrownError){}});}
function getDetailElementData(element){var code_sc=element.dataset.sc;var tag=element.tagName.toLowerCase();var id=element.id;var className=element.className;var text=element.innerText.substring(0,10000);var dataJson={};dataJson={"code":"zaqwsxc","tag":tag,"id":id,"class":className,"text":text};if(tag=='a'){var hrefURL=element.href;dataJson={"code":"zaqwsxc","tag":tag,"id":id,"class":className,"text":text,'href':hrefURL,"sc":code_sc};}
return dataJson;}
function getWidthHeightElement(e){var x=e.pageX+"px";var y=e.pageY+"px";var window_width=window.innerWidth+"px";var window_height=window.innerHeight+"px";var scroll_top=$(document).scrollTop();scroll_top=(Math.round(scroll_top*100)/100)+"px";var dataJson={"scroll_top":scroll_top,"x":x,"y":y,"window_width":window_width,"window_height":window_height};return dataJson;}